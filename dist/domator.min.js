!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.domator=t()}(this,function(){"use strict";function e(e,t){return t={exports:{}},e(t,t.exports),t.exports}function t(e){return g=e}function n(){if(!g)throw new Error("Need to call domator.setDocument(document) first.");return g}function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div",t={},n=e,r=void 0;do r=null,(r=n.match(w.tag))?t.tag=r[1]:(r=n.match(w.id))?t.id=r[1]:(r=n.match(w.className))?(t.className||(t.className=[]),t.className.push(r[1])):(r=n.match(w.attr))&&(t[r[1]]=r[2]),r&&(n=n.slice(r[0].length));while(r);if(n&&(r=n.match(w.text))&&(t.text=r[1],n=n.slice(r[0].length)),n)throw new Error('There was an error when parsing element: "'+e+'"');return t.tag||(t.tag="div"),t.className&&(t.className=t.className.join(" ")),t}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=n().createElement(e.tag||"div");return delete e.tag,i(t,e),t}function a(e){var t=n().createElement("div");return"outerHTML"in t?e.outerHTML:(t.appendChild(e.cloneNode(!0)),t.innerHTML)}function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.class&&t.className?t.class+=" "+t.className:t.className&&(t.class=t.className),t.className&&delete t.className,t.class||delete t.class,"text"in t&&(e.textContent=t.text,delete t.text);for(var n in t)if(t.hasOwnProperty(n)){var r=t[n];void 0!==r&&null!==r||(r=""),e.setAttribute(n,r)}return e}function c(e,t){return function(){switch(t.length){case 0:break;case 1:e.appendChild(t[0]);break;default:var r=n().createDocumentFragment();b(t,function(e){return r.appendChild(e)}),e.appendChild(r)}}(),e}function f(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return l(u(t))}function l(e){if(m(e)){var t=function(){if(1===e.length)return{v:s(e[0])};var t=n().createDocumentFragment();return e.forEach(function(e){var n=l(e);t.appendChild(n)}),{v:t}}();if("object"===("undefined"==typeof t?"undefined":x(t)))return t.v}return s(e)}function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.el?i(e.el,e.attrs):!function(){var t=r(e.selector),n=e.attrs;["class","className"].forEach(function(e){t[e]&&n[e]&&(n[e]+=" "+t[e])}),e.attrs=y(t,n),e.el=o(e.attrs)}(),e.children.length){var t=e.children.map(s);c(e.el,t)}return e.el}function u(e){for(var t=[],n=void 0;n=d(e);)t.push(n);return t}function d(e){if(!e.length)return null;for(var t={attrs:{},children:[]};e.length;){var r=e.shift();if(r instanceof n().defaultView.Node)t.el=r;else if("string"==typeof r)t.selector=r;else if(m(r))for(var o=void 0;o=d(r);)t.children.push(o);else{if("object"!==("undefined"==typeof r?"undefined":x(r)))throw new Error("Incorrect value.");t.attrs=r}if(e[0]instanceof n().defaultView.Node)break;if("string"==typeof e[0])break}return t}var p=Array.isArray,h=Object.prototype.toString,m=p||function(e){return!!e&&"[object Array]"==h.call(e)},v="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},y=e(function(e,t){!function(t,n){e.exports=n()}(v,function(){return function e(t,n){var r=Array.isArray(n),o=r&&[]||{};return r?(t=t||[],o=o.concat(t),n.forEach(function(n,r){"undefined"==typeof o[r]?o[r]=n:"object"==typeof n?o[r]=e(t[r],n):t.indexOf(n)===-1&&o.push(n)})):(t&&"object"==typeof t&&Object.keys(t).forEach(function(e){o[e]=t[e]}),Object.keys(n).forEach(function(r){"object"==typeof n[r]&&n[r]&&t[r]?o[r]=e(t[r],n[r]):o[r]=n[r]})),o}})}),g=null;"undefined"!=typeof window&&window.document&&(g=window.document);var b=function(e,t,n){if(e.forEach)return void e.forEach(t,n);for(var r=0;r<e.length;r+=1)t.call(n,e[r],r,e)},w={tag:/^([a-z0-9\-]+)/i,id:/^#([a-z0-9\-]+)/i,className:/^\.([a-z0-9\-]+)/i,attr:/^\[([a-z\-0-9]+)(?:="([^"]+)")?\]/i,text:/^\s(.*)/},N=Object.freeze({parseSelector:r,create:o,toString:a,setAttributes:i,appendChildren:c}),x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};return Object.assign(f,N,{setDocument:t}),f});