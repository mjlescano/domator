!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.domator=t()}(this,function(){"use strict";function e(e,t){return t={exports:{}},e(t,t.exports),t.exports}function t(){if(!y)throw new Error("Need to call domator.setDocument(document) first.");for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return r(i(t))}function n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.class=(t.class||[]).concat(t.className).join(" "),t.className&&delete t.className,t.class||delete t.class;for(var n in t)t.hasOwnProperty(n)&&e.setAttribute(n,t[n]||n);return e}function r(e){if(u(e)){var o=function(){if(1===e.length)return{v:r(e[0])};var t=y.createDocumentFragment();return l(e,function(e){var n=r(e);t.appendChild(n)}),{v:t}}();if("object"===("undefined"==typeof o?"undefined":p(o)))return o.v}return e.tag?e.el=t.create(e.tag,e.attrs):n(e.el,e.attrs),e.children&&l(e.children,function(t){e.el.appendChild(r(t))}),e.el}function o(e){var t={},n=e,r=void 0;do r=null,(r=n.match(h.tag))?t.tag=r[1]:(r=n.match(h.id))?t.id=r[1]:(r=n.match(h.className))?(t.className||(t.className=[]),t.className.push(r[1])):(r=n.match(h.attr))&&(t[r[1]]=r[2]),r&&(n=n.slice(r[0].length));while(r);if(n&&(r=n.match(h.text))&&(t.text=r[1],n=n.slice(r[0].length)),n)throw new Error('There was an error when parsing element name: "'+e+'"');return t}function i(e){for(var t=[],n=void 0;n=a(e);)t.push(n);return t}function a(e){if(!e.length)return null;for(var t={children:[]};;){var n=e.shift();if(n instanceof y.defaultView.Node)t.el=n;else if("string"==typeof n)t.tag=n;else if(u(n))for(var r=void 0;r=a(n);)t.children.push(r);else{if("object"!==("undefined"==typeof n?"undefined":p(n)))throw new Error("Incorrect value.");t.attrs=n}if(!e[0])break;if(e[0]instanceof y.defaultView.Node)break;if("string"==typeof e[0])break}return t}var f=Array.isArray,c=Object.prototype.toString,u=f||function(e){return!!e&&"[object Array]"==c.call(e)},l=function(e,t,n){if(e.forEach)return void e.forEach(t,n);for(var r=0;r<e.length;r+=1)t.call(n,e[r],r,e)},s="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},d=e(function(e,t){!function(t,n){e.exports=n()}(s,function(){return function e(t,n){var r=Array.isArray(n),o=r&&[]||{};return r?(t=t||[],o=o.concat(t),n.forEach(function(n,r){"undefined"==typeof o[r]?o[r]=n:"object"==typeof n?o[r]=e(t[r],n):t.indexOf(n)===-1&&o.push(n)})):(t&&"object"==typeof t&&Object.keys(t).forEach(function(e){o[e]=t[e]}),Object.keys(n).forEach(function(r){"object"==typeof n[r]&&n[r]&&t[r]?o[r]=e(t[r],n[r]):o[r]=n[r]})),o}})}),p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h={tag:/^([a-z0-9\-]+)/i,id:/^#([a-z0-9\-]+)/i,className:/^\.([a-z0-9\-]+)/i,attr:/^\[([a-z\-0-9]+)(?:="([^"]+)")?\]/i,text:/^\s(.*)/},y=void 0;return t.setDocument=function(e){return y=e,t},t.toString=function(e){var t=y.createElement("div");return"outerHTML"in t?e.outerHTML:(t.appendChild(e.cloneNode(!0)),t.innerHTML)},t.create=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=o(e),["class","className"].forEach(function(n){"string"==typeof e[n]&&(e[n]=[e[n]]),"string"==typeof t[n]&&(t[n]=[t[n]])}),t=d(e,t);var r=y.createElement(t.tag||"div");return delete t.tag,"text"in t&&(r.textContent=t.text,delete t.text),n(r,t),r},"undefined"!=typeof window&&window.document&&t.setDocument(window.document),t});