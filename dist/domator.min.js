!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.domator=t()}(this,function(){"use strict";function e(e,t){return t={exports:{}},e(t,t.exports),t.exports}function t(e){return w=e}function r(){if(!w)throw new Error("Need to call domator.setDocument(document) first.");return w}function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div",t={},r=e,n=void 0;if(r&&(n=r.match(x.text)))return t.text=n[1],t;do n=null,(n=r.match(x.tag))?t.tag=n[1]:(n=r.match(x.id))?t.id=n[1]:(n=r.match(x.className))?(t.className||(t.className=[]),t.className.push(n[1])):(n=r.match(x.attr))&&(t[n[1]]=n[2]),n&&(r=r.slice(n[0].length));while(n);if(t.tag||" "===e[0]||(t.tag="div"),r&&(n=r.match(x.text))&&(t.text=n[1],r=r.slice(n[0].length)),r)throw new Error('There was an error when parsing element: "'+e+'"');return t.className&&(t.className=t.className.join(" ")),t}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=r().createElement(e.tag||"div");return delete e.tag,i(t,e),t}function o(e){var t=r().createElement("div");return"outerHTML"in t?e.outerHTML:(t.appendChild(e.cloneNode(!0)),t.innerHTML)}function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.class&&t.className?t.class+=" "+t.className:t.className&&(t.class=t.className),t.className&&delete t.className,t.class||delete t.class;for(var r in t)if(t.hasOwnProperty(r)){var n=t[r];void 0!==n&&null!==n||(n=""),e.setAttribute(r,n)}return e}function c(e,t){return function(){switch(t.length){case 0:break;case 1:e.appendChild(t[0]);break;default:var n=r().createDocumentFragment();N(t,function(e){return n.appendChild(e)}),e.appendChild(n)}}(),e}function l(e){for(;e.firstChild;)e.removeChild(e.firstChild);return e}function f(e,t){return l(e),c(e,t)}function u(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return s(h(t))}function s(e){if(v(e)){var t=function(){if(1===e.length)return{v:d(e[0])};var t=r().createDocumentFragment();return e.forEach(function(e){var r=s(e);t.appendChild(r)}),{v:t}}();if("object"===("undefined"==typeof t?"undefined":E(t)))return t.v}return d(e)}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.selector&&!function(){var t=n(e.selector),r=e.attrs;["class","className"].forEach(function(e){t[e]&&r[e]&&(r[e]+=" "+t[e])}),e.attrs=b.all([{},t,r])}(),!e.el&&e.attrs.tag&&(e.el=r().createElement(e.attrs.tag),delete e.attrs.tag),"text"in e.attrs){if(!e.el)return r().createTextNode(e.attrs.text);e.children.unshift({attrs:{text:e.attrs.text}}),delete e.attrs.text}e.el?i(e.el,e.attrs):e.el=r().createDocumentFragment();var t=e.children.map(d);return f(e.el,t),e.el}function h(e){for(var t=[],r=void 0;r=m(e);)t.push(r);return t}function m(e){if(!e.length)return null;for(var t={attrs:{},children:[]};e.length;){var n=e.shift();if(n instanceof r().defaultView.Node)t.el=n;else if("string"==typeof n)t.selector=n;else if(v(n))for(var a=void 0;a=m(n);)t.children.push(a);else{if("object"!==("undefined"==typeof n?"undefined":E(n)))throw new Error("Incorrect value.");t.attrs=n}if(e[0]instanceof r().defaultView.Node)break;if("string"==typeof e[0])break}return t}var p=Array.isArray,y=Object.prototype.toString,v=p||function(e){return!!e&&"[object Array]"==y.call(e)},g="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},b=e(function(e,t){!function(t,r){e.exports=r()}(g,function(){function e(e){var t=e&&"object"==typeof e;return t&&"[object RegExp]"!==Object.prototype.toString.call(e)&&"[object Date]"!==Object.prototype.toString.call(e)}function t(e){return Array.isArray(e)?[]:{}}function r(r,n){var a=n&&n.clone===!0;return a&&e(r)?o(t(r),r,n):r}function n(t,n,a){var i=t.slice();return n.forEach(function(n,c){"undefined"==typeof i[c]?i[c]=r(n,a):e(n)?i[c]=o(t[c],n,a):t.indexOf(n)===-1&&i.push(r(n,a))}),i}function a(t,n,a){var i={};return e(t)&&Object.keys(t).forEach(function(e){i[e]=r(t[e],a)}),Object.keys(n).forEach(function(c){e(n[c])&&t[c]?i[c]=o(t[c],n[c],a):i[c]=r(n[c],a)}),i}function o(e,t,o){var i=Array.isArray(t),c=o||{arrayMerge:n},l=c.arrayMerge||n;return i?Array.isArray(e)?l(e,t,o):r(t,o):a(e,t,o)}return o.all=function(e,t){if(!Array.isArray(e)||e.length<2)throw new Error("first argument should be an array with at least two elements");return e.reduce(function(e,r){return o(e,r,t)})},o})}),w=null;"undefined"!=typeof window&&window.document&&(w=window.document);var N=function(e,t,r){if(e.forEach)return void e.forEach(t,r);for(var n=0;n<e.length;n+=1)t.call(r,e[n],n,e)},x={tag:/^([a-z0-9\-]+)/i,id:/^#([a-z0-9\-]+)/i,className:/^\.([a-z0-9\-]+)/i,attr:/^\[([a-z\-0-9]+)(?:="([^"]+)")?\]/i,text:/^\s(.*)/},j=Object.freeze({parseSelector:n,create:a,toString:o,setAttributes:i,appendChildren:c,removeChildren:l,setChildren:f}),E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};return Object.assign(u,j,{setDocument:t}),u});